<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>KIKU DASHBOARD</title>
  <!-- links -->
  <link rel="stylesheet" href="dashboard.css">
  <!-- CSS only -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
    integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">
  <!-- JS, Popper.js, and jQuery -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
    integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
    crossorigin="anonymous"></script>


</head>

<body ng-app="dash" ng-controller="dashController">
  <div class="content container-fluid">
    <div class="row bg-dark">
      <div class="col-lg-2 col-md-2 col-sm-6 col-xs-12  side-navigation">
        <div class="aside">
          <!-- <h3>side</h3> -->
          <nav class="side-nav">
            <header>
              <!-- <span></span>
              John Doe
              <a></a> -->
              <div class="profile">
                <img src="../images/male-icon.png" alt="card-img-top" height="100" width="100">
                <span class="text-light">{{username}}</span>
                <div class="edit mx-auto">
                  <span class="text-light"><a href="">Edit</a></span>
                  <span class="text-light"><a href="" ng-click="logout()">Logout</a></span>
                </div>
              </div>
            </header>

            <ul class="side-nav-links">
              <li><a href="dash.html">Dashboard</a></li>
              <li><a href="products.html" class="active">Products</a></li>
              <!-- <li><a>Roadmap</a></li>
              <li><a>Milestones</a></li>
              <li><a>Tickets</a></li>
              <li><a>GitHub</a></li>
              <li><span>Other</span></li>
              <li><a>Search</a></li>
              <li><a>Settings</a></li> -->
              <li><a ng-click="logout()">Logout</a></li>
            </ul>

          </nav>
        </div>
      </div>
      <div class="col-lg-10 col-md-10 col-sm-6 col-xs-12 bg-light ">
        <div class="  ">
          <div class="row mt-3 mb-2">
            <div class="col-md-6">
              <h3>Dashboard</h3>
            </div>
            <div class="col-md-6">
              <div class="search ">
                <div class="float-right">
                  <form action="">
                    <input type="text" class="form-control dash-search" placeholder="Search..." ng-model="search_query">
                  </form>
                </div>
              </div>
            </div>
          </div>

          <!-- products -->
          <div class="animated fadeIn mt-5">
            <div class="row">
              <div class="col-md-12">
                <div class="card">
                  <div class="card-header">
                    <div class="row">
                      <div class="col-md-10"><strong class="card-title">Products</strong></div>
                      <div class="col-md-2">
                        <!-- <button class="btn btn-grin float-right" data-toggle="modal"
                          data-target="#"><span class="text-light display-5 font-weight-bold"
                            ng-click="add_product = ! add_product">Add</span></button> -->
                        <button class="btn btn-grin float-right" data-toggle="modal" data-target="#"><span
                            class="text-light display-5 font-weight-bold" data-toggle="modal"
                            data-target="#add_product">Add</span></button>
                      </div>
                    </div>
                  </div>
                  <div class="card-body ">
                    <div class="table-responsive">
                      <table id="bootstrap-data-table" class="table table-striped table-bordered  ">
                        <thead>
                          <!-- <tr>
                            <th><button class="btn btn-danger" ng-click="deleteAll()">Delete Selected</button></th>
                          </tr> -->
                          <tr>
                            <!-- <th>Select</th> -->
                            <th>Name</th>
                            <th>Qty</th>
                            <th>Price(pkg)</th>
                            <th>Category</th>
                            <th>Date</th>
                            <th>Action</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr class="table-huva"
                            ng-repeat="product in products | filter:search_query | orderBy:'-created_at'">
                            <style>
                              .table-huva:hover {
                                background-color: #00c29267 !important;
                              }
                            </style>
                            <!-- <td><input name="all" type="checkbox" ng-checked="product.id" /></td></td> -->
                            <td>{{product.product_name}}</td>
                            <td>{{product.quantity}}</td>
                            <td>{{product.amount}} Rwf</td>
                            <td ng-repeat="cat in categories" ng-if="product.category_id ==cat.id">{{cat.category_name}}
                            </td>
                            <td>
                              <span>{{product.created_at}}</span>
                            </td>
                            <td>
                              <button class="btn btn-blu" ng-click="showProduct(product)">View</button>
                              <button class="btn btn-danger" ng-click="deleteProduct(product.id)">Delete</button>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </div>
                </div>
              </div>

            </div>
          </div><!-- .animated -->
          <!-- / .products -->

          <!-- add product -->

          <!-- / .add product -->
        </div>
      </div>


    </div>
  </div>

  <!-- modals -->
  <!-- add product -->
  <div class="modal fade" id="add_product" tabindex="-1" role="dialog" aria-labelledby="mediumModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="mediumModalLabel">Add Product</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="mt-3" ng-show="!add_product">
            <h3>Add Product</h3>
            <div>
              <div class="card mt-2 mb-3" style="border-left: 3px solid #00c292;">
                <div class="card-body">
                  <form id="dimage"> 
                    <div class="tab-content" id="nav-tabContent" ng-show="!product_specification">
                      <!-- product-details -->
                      <strong>Product Details</strong>
                      <div class="row mt-3">
                        <div class="col-md-6">
                          <div class="input-group">
                            <div class="form-group col-12">
                              <input type="text" placeholder="Product name" id="product_name"
                                class="form-control product_name" ng-model="product.product_name">
                            </div>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="input-group">
                            <div class="form-group col-12">
                              <input type="text" placeholder="Quantity" id="product_qty" class="form-control"
                                ng-model="product.product_qty">
                            </div>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="input-group">
                            <div class="form-group col-12">
                              <input type="text" placeholder="Price" id="product-price" class="form-control"
                                ng-model="product.product_price">
                            </div>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="input-group">
                            <div class="form-group col-12">
                              <!-- <input type="text" placeholder="Product Category" id="product_cat" class="form-control"
                                ng-model="product.product_cat"> -->
                              <!-- <select ng-model="product.product_cat" class="form-control">
                                  <option >Choose Category</option>
                                  <option ng-repeat="cat in categories" value="{{cat.id}}">{{cat.category_name}}</option>
                                </select> -->
                              <select class="form-control" ng-model="product.product_cat"
                                ng-options="cat.category_name for cat in categories">
                                <option value="">-- choose Category --</option>
                              </select>
                            </div>
                          </div>
                        </div>
                        <div class="next ml-auto">
                          <button class="btn btn-grin" id="next_form" ng-click="next(product)"
                            ng-show="!product_specification">Next</button>
                        </div>
                      </div>
                    </div>
                    <!-- // product-details -->

                    <!-- product specification -->
                    <div class="product-specification" ng-show="product_specification">
                      <strong>Product Specification</strong>
                      <div class="row mt-3">
                        <div class="col-md-3">
                          <div class="input-group">
                            <div class="form-group">
                              <input type="text" placeholder="Fineness" class="form-control"
                                ng-model="product.fineness">
                            </div>
                          </div>
                        </div>
                        <div class="col-md-3">
                          <div class="input-group">
                            <div class="form-group">
                              <input type="text" placeholder="Strength" class="form-control"
                                ng-model="product.strength">
                            </div>
                          </div>
                        </div>

                        <div class="col-md-3">
                          <div class="input-group">
                            <div class="form-group">
                              <input type="text" placeholder="Weight" class="form-control" ng-model="product.weight">
                            </div>
                          </div>
                        </div>
                        <div class="col-md-3">
                          <div class="input-group">
                            <div class="form-group col-12">
                              <select class="form-control" ng-model="product.manufacturer"
                                ng-options="man for man in manufacturers">
                                <option value="">Manufacturer </option>
                              </select>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-4">
                          <div class="input-group">
                            <div class="form-group col-12">
                              <!-- <select class="form-control" 
                                name="product_color" ng-model="product.product_color">
                                <option value="null" selected>Choose Product Color</option>
                                <option value="grey">Grey</option>
                                <option value="dark">Dark</option>
                                <option value="green">Green</option>
                                <option value="white">White</option>
                                <option value="brown">Brown</option>
                              </select> -->
                              <select class="form-control" ng-model="product.product_color"
                                ng-options="col for col in colors">
                                <option value="">-- choose Color --</option>
                              </select>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-4">
                          <div class="input-group">
                            <div class="form-group col-12">
                              <!-- <select class="form-control" data-placeholder="Choose product usage..."
                                name="product_usage" ng-model="product.product_usage">
                                <option value="null" selected>choose Product Usage</option>
                                <option value="civil">Civil Construction</option>
                                <option value="road">Road Constuction</option>                                
                              </select> -->
                              <select class="form-control" ng-model="product.product_usage"
                                ng-options="us for us in usage">
                                <option value="">-- Product Usage --</option>
                              </select>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-4">
                          <div class="input-group">
                            <div class="form-group col-12">
                              <!-- <select class="form-control" data-placeholder="Choose packaging type..."
                                name="product_pkging" ng-model="product.product_pkging">
                                <option value="null" selected>Choose Packaging Type</option>
                                <option value="PP Sack Bag">PP Sack Bag</option>
                              </select> -->
                              <select class="form-control" ng-model="product.product_pkging"
                                ng-options="pk for pk in pkging">
                                <option value="">-- choose Packaging Type --</option>
                              </select>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="input-group">
                            <div class="form-group col-12">
                              <input type="file" name="img" ng-model="img" id="img">
                            </div>
                          </div>
                        </div>

                        <div class="next ml-auto">
                          <button class="btn btn-grin" ng-click="product_specification=!product_specification"
                            ng-show="product_specification">Previous</button>
                          <button class="btn btn-grin" ng-click="addProduct(product)">Add Product</button>
                        </div>
                      </div>
                    </div>
                    <!-- <div class="addedProductdetails bg-light container mt-3">
                      <pre> {{product | json}} </pre>
                    </div> -->
                    <!-- product sepcification -->
                  </form>
                </div>
              </div>
            </div>

          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
          <!-- <button type="button" class="btn btn-primary">Confirm</button> -->
        </div>
      </div>
    </div>
  </div>
  <!-- / .add product -->

  <!-- show product  -->
  <div class="modal fade show_product" id="show_product" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg show_product">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Product Details</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-md-5">
              <img ng-src=" ../images/products/{{show_image}} " on-error="../images/err.png" width="300" alt="card-img">
            </div>
            <div class="col-md-7">
              <p class="card-text"><strong>Name : {{show_product_name}}</strong></p>
              <p class="card-text ">Price : {{show_amount}} Rwf</p>
              <p class="card-text ">Quantity : {{show_quantity}}</p>
              <p class="card-text ">Weight : {{show_weight}} Kg</p>
              <p class="card-text ">Color : {{show_color}}</p>
              <p class="card-text ">Strength : {{show_strength}}+ mpa</p>
              <p class="card-text ">Fineness : {{show_fineness}}</p>
              <p class="card-text ">Application : {{show_application}}</p>
              <p class="card-text ">Manufacturer : {{show_manufacturer}}</p>
              <p class="card-text "><span class="text-muted">Date created : {{show_created_at}}</span></p>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-blu" ng-click="editProduct(show_product_id)">Edit</button>
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
          <!-- <button type="button" class="btn btn-primary">Save changes</button> -->
        </div>
      </div>
    </div>
  </div>
  <!-- / .show product -->

  <!-- edit product -->
  <div class="modal fade" id="edit_product" tabindex="-1" role="dialog" aria-labelledby="mediumModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="mediumModalLabel">Add Product</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div class="mt-3" ng-show="!add_product">
            <h3>Add Product</h3>
            <div>
              <div class="card mt-2 mb-3" style="border-left: 3px solid #00c292;">
                <div class="card-body">
                  <form>
                    <div class="tab-content" id="nav-tabContent" ng-show="!product_specification">
                      <!-- product-details -->
                      <strong>Product Details</strong>
                      <div class="row mt-3">
                        <div class="col-md-6">
                          <div class="input-group">
                            <div class="form-group col-12">
                              <input type="text" placeholder="Product name" id="product_name"
                                class="form-control product_name" ng-model="edit_product_name">
                            </div>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="input-group">
                            <div class="form-group col-12">
                              <input type="text" placeholder="Quantity" id="product_qty" class="form-control"
                                ng-model="edit_product_qty">
                            </div>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="input-group">
                            <div class="form-group col-12">
                              <input type="text" placeholder="Price" id="product-price" class="form-control"
                                ng-model="edit_product_price">
                            </div>
                          </div>
                        </div>
                        <div class="col-md-6">
                          <div class="input-group">
                            <div class="form-group col-12">
                              <!-- <input type="text" placeholder="Product Category" id="product_cat" class="form-control"
                                ng-model="product.product_cat"> -->
                              <!-- <select ng-model="edit_product_cat" class="form-control">
                                <option >Choose Category</option>
                                <option ng-if="cat.id == edit_product_cat" value="cat.id" >{{cat.category_name}}</option>
                                <option ng-repeat="cat in categories"  value="{{cat.id}}">{{cat.category_name}}</option>
                              </select> -->
                              <select class="form-control" ng-model="edit_product_cate"
                                ng-options="cat.category_name for cat in categories">
                                <option ng-repeat="cat in categories" class="bg-grin" ng-if="edit_product_cat == cat.id"
                                  value="">{{cat.category_name}}</option>
                              </select>
                            </div>
                          </div>
                        </div>
                        <div class="next ml-auto">
                          <button class="btn btn-grin" id="next_form"
                            ng-click="product_specification =!product_specification"
                            ng-show="!product_specification">Next</button>
                        </div>
                      </div>
                    </div>
                    <!-- // product-details -->

                    <!-- product specification -->
                    <div class="product-specification" ng-show="product_specification">
                      <strong>Product Specification</strong>
                      <div class="row mt-3">
                        <div class="col-md-3">
                          <div class="input-group">
                            <div class="form-group">
                              <input type="text" placeholder="Fineness" class="form-control" ng-model="edit_fineness">
                            </div>
                          </div>
                        </div>
                        <div class="col-md-3">
                          <div class="input-group">
                            <div class="form-group">
                              <input type="text" placeholder="Strength" class="form-control" ng-model="edit_strength">
                            </div>
                          </div>
                        </div>

                        <div class="col-md-3">
                          <div class="input-group">
                            <div class="form-group">
                              <input type="text" placeholder="Weight" class="form-control" ng-model="edit_weight">
                            </div>
                          </div>
                        </div>
                        <div class="col-md-3">
                          <div class="input-group">
                            <div class="form-group col-12">
                              <select class="form-control" ng-model="edit_manufacturer"
                                ng-options="man for man in manufacturers">
                                <option value="">Manufacturer </option>
                              </select>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-4">
                          <div class="input-group">
                            <div class="form-group col-12">
                              <!-- <select class="form-control" 
                                name="product_color" ng-model="product.product_color">
                                <option value="null" selected>Choose Product Color</option>
                                <option value="grey">Grey</option>
                                <option value="dark">Dark</option>
                                <option value="green">Green</option>
                                <option value="white">White</option>
                                <option value="brown">Brown</option>
                              </select> -->
                              <select class="form-control" ng-model="edit_product_color"
                                ng-options="col for col in colors">
                                <option value="">-- choose Color --</option>
                              </select>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-4">
                          <div class="input-group">
                            <div class="form-group col-12">
                              <!-- <select class="form-control" data-placeholder="Choose product usage..."
                                name="product_usage" ng-model="product.product_usage">
                                <option value="null" selected>choose Product Usage</option>
                                <option value="civil">Civil Construction</option>
                                <option value="road">Road Constuction</option>                                
                              </select> -->
                              <select class="form-control" ng-model="edit_product_usage"
                                ng-options="us for us in usage">
                                <option value="">-- Product Usage --</option>
                              </select>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-4">
                          <div class="input-group">
                            <div class="form-group col-12">
                              <!-- <select class="form-control" data-placeholder="Choose packaging type..."
                                name="product_pkging" ng-model="product.product_pkging">
                                <option value="null" selected>Choose Packaging Type</option>
                                <option value="PP Sack Bag">PP Sack Bag</option>
                              </select> -->
                              <select class="form-control" ng-model="edit_product_pkging"
                                ng-options="pk for pk in pkging">
                                <option value="">-- choose Packaging Type --</option>
                              </select>
                            </div>
                          </div>
                        </div>
                        <!-- <div class="col-md-6">
                          <div class="input-group">
                            <div class="form-group col-12">
                              <input type="file" name="img" ng-model="img">
                            </div>
                          </div>
                        </div> -->

                        <div class="next ml-auto">
                          <button class="btn btn-grin" ng-click="product_specification=!product_specification"
                            ng-show="product_specification">Previous</button>
                          <button class="btn btn-grin" ng-click="updateProduct()">Update Product</button>
                        </div>
                      </div>
                    </div>
                    <!-- <div class="addedProductdetails bg-light container mt-3">
                      <pre> {{product | json}} </pre>
                    </div> -->
                    <!-- product sepcification -->
                  </form>
                </div>
              </div>
            </div>

          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
          <!-- <button type="button" class="btn btn-primary">Confirm</button> -->
        </div>
      </div>
    </div>
  </div>
  <!-- /.edit product -->
  <!-- /.modals -->
  <script>

  </script>
  <script src="dashboard.js"></script>
  <script src="js/angular.min.js"></script>
  <script src="js/dashboard.js"></script>
  <script src="js/sweetalert2.js"></script>
  <script>
    var app = angular.module('dash', []);
    app.controller('dashController', function ($scope, $http, $window) {

      $scope.products = [];
      $scope.colors = ['grey', 'dark', 'white', 'brown'];
      $scope.usage = ['Civil Construction', 'Road Constuction'];
      $scope.pkging = ['PP Sack Bag'];
      $scope.manufacturers = ['Cimerwa', 'Star Lab', 'Dangote Ltd', 'TZ Portland'];
      $scope.getProducts = () => {
        $http.get("../api/getProducts.php").then((Response) => {
          $scope.products = Response.data;
          // console.log(Response.data)     
        })
      }

      $scope.getCategories = () => {
        $http.get("../api/getCategories.php").then((Response) => {
          $scope.categories = Response.data;
        })
      }
      // $scope.addProduct = function () {        
      //   $http({
      //     url: '../api/addProduct.php',
      //     method: 'POST'
      //   }).then(function (res) {
      //     // $scope.products.push(product);
      //     $scope.add_product = false;
      //     // $(".modal").modal("hide");
      //   });
      // }

      $scope.next = (product) => {
        if (product.product_name == null) {

        } else {
          $scope.product_specification = true;
        }
      }

      $scope.addProduct = (product) => {
        var fileName = document.getElementById('img').files[0].name;
        info_product = {
          method: 'POST',
          url: '../api/addProduct.php',
          data: {
            'product_name': product.product_name,
            'product_qty': product.product_qty,
            'product_price': product.product_price,
            'product_cat': product.product_cat.id,
            'fineness': product.fineness,
            'strength': product.strength,
            'color': product.product_color,
            'weight': product.weight,
            'usage': product.product_usage,
            'packaging': product.product_pkging,
            'manufacturer': product.manufacturer,
            'image':fileName

          }
        };       
            
          // console.log(fileName);
        // console.log(product.product_cat.id);
        let post_product = $http(info_product);
        post_product.then((response) => {

          $("#add_product").modal("hide");
          $scope.added_product_msg = response.data;

          // console.log(response.data);

          if (response.data == 'done') {
            swal({
              type: 'success',
              confirmButtonColor: '#00c292',
              text: 'Product Added Successfully!'
            }).then((result) => {
              if (result.value) {
                $window.location.href = "products.html";
              }
            })
          }
          else {
            swal({
              type: 'error',
              title: 'Oops...',
              text: 'Something went wrong!',
              confirmButtonColor: '#b21f2d'
            })
          }
        });
      }

      $scope.showProduct = (product) => {
        $('#show_product').modal('show');
        let show_products = {
          method: 'POST',
          url: '../api/showProduct.php',
          data: {
            id: product.id
          }
        };
        $http(show_products).then((res) => {
          data = res.data;
          // console.log(data[0].fineness);
          $scope.show_fineness = data[0].fineness;
          $scope.show_strength = data[0].compressive_strength;
          $scope.show_color = data[0].color;
          $scope.show_weight = data[0].weight;
          $scope.show_application = data[0].application;
          $scope.show_packaging_type = data[0].packaging_type;
        });

        $scope.show_product_name = product.product_name;
        $scope.show_quantity = product.quantity;
        $scope.show_amount = product.amount;
        $scope.show_manufacturer = product.manufacturer;
        $scope.show_created_at = product.created_at;
        $scope.show_product_id = product.id;
        $scope.show_image = product.image;
        // alert(product.product_name);
      }

      $scope.editProduct = (show_product_id) => {
        $('#edit_product').modal('show');
        let edit_products = {
          method: 'POST',
          url: '../api/editProduct.php',
          data: {
            id: show_product_id
          }
        };
        $http(edit_products).then((res) => {
          product = res.data;
          $scope.edit_product_name = product[0].product_name;
          $scope.edit_product_qty = product[0].quantity;
          $scope.edit_product_price = product[0].amount;
          $scope.edit_product_cat = product[0].category_id;
          $scope.edit_fineness = product[0].fineness;
          $scope.edit_strength = product[0].compressive_strength;
          $scope.edit_weight = product[0].weight;
          $scope.edit_manufacturer = product[0].manufacturer;
          $scope.edit_product_color = product[0].color;
          $scope.edit_product_usage = product[0].application;
          $scope.edit_product_pkging = product[0].packaging_type;
          $scope.product_id = product[0].id;

          // console.log(product[0].category_id);

        })
      }

      $scope.updateProduct = () => {
        if ($scope.edit_product_cate == undefined) {
          var product_cat_id = $scope.edit_product_cat;
        } else {
          var product_cat_id = $scope.edit_product_cate.id;
        }
        let update_products = {
          method: 'POST',
          url: '../api/updateProduct.php',
          data: {
            'product_id': $scope.product_id,
            'edit_product_name': $scope.edit_product_name,
            'edit_product_qty': $scope.edit_product_qty,
            'edit_product_price': $scope.edit_product_price,
            'edit_product_cat': product_cat_id,
            'edit_fineness': $scope.edit_fineness,
            'edit_strength': $scope.edit_strength,
            'edit_weight': $scope.edit_weight,
            'edit_manufacturer': $scope.edit_manufacturer,
            'edit_product_color': $scope.edit_product_color,
            'edit_product_usage': $scope.edit_product_usage,
            'edit_product_pkging': $scope.edit_product_pkging,
          }
        };
        $http(update_products).then((res) => {
          if (res.data == 'done') {
            swal({
              type: 'success',
              confirmButtonColor: '#00c292',
              text: 'Product Updated Successfully!'
            }).then((result) => {
              if (result.value) {
                $window.location.href = "products.html";
              }
            })
          }
          else {
            swal({
              type: 'error',
              title: 'Oops...',
              text: 'Something went wrong!',
              confirmButtonColor: '#b21f2d'
            })
          }
        })
        // console.log(product_cat_id);
      }

      $scope.deleteProduct = (id) => {
        // console.log(id);
        let delete_product = {
          method: 'POST',
          url: '../api/deleteProduct.php',
          data: {
            'product_id': id
          }
        };
        if (id != null) {
          Swal.fire({
            title: 'Are you sure?',
            text: "You won't be able to revert this!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Yes, delete it!'
          }).then((result) => {
            if (result.value) {
              $http(delete_product).then((res) => {
                if (res.data == 'done') {
                  Swal.fire(
                    'Deleted!',
                    'Your file has been deleted.',
                    'success'
                  ).then((result) => {
                    if (result.value) {
                      $window.location.href = "products.html";
                    }
                  })
                } else {
                  swal.fire({
                    text: res.data
                  })
                }
              })
            }
          })
        }
        // $http(delete_product).then((res) => {
        //   if (res.data == 'done') {
        //     swal({
        //       type: 'success',
        //       confirmButtonColor: '#00c292',
        //       text: 'Product Updated Successfully!'
        //     }).then((result) => {
        //       if (result.value) {
        //         $window.location.href = "products.html";
        //       }
        //     })
        //   }
        //   else {
        //     swal({
        //       type: 'error',
        //       title: 'Oops...',
        //       text: 'Something went wrong!',
        //       confirmButtonColor: '#b21f2d'
        //     })
        //   }
        // })

      }

      $scope.getProducts();
      $scope.getCategories();

      $scope.username = localStorage.getItem('username');

      $scope.logout = () => {
        // $scope.loggedin = false;
        if (localStorage.getItem('username') != null) {
          var removeUser = localStorage.removeItem('username');
          // $window.location.href = "./dashboard/dash.html";
        }
        $window.location.href = "../api/logout.php";
      }
    });

    app.directive('onError', function () {
      return {
        restrict: 'A',
        link: function (scope, element, attr) {
          element.on('error', function () {
            element.attr('src', attr.onError);
          })
        }
      }
    })
  </script>
  <script>
    // $(document).ready(function(){
    //   $('#next_form').click(function(){
    //     if($('#product_name') || $('#product_qty') || $('#product_price') || $('#product_cat').empty()){
    //       swal({
    //           type: 'error',
    //           title: 'Oops...',
    //           text: 'Fill all the field first!',
    //           confirmButtonColor: '#b21f2d'
    //         }).then((result) => {
    //           if (!result.value) {
    //             return;
    //           }
    //         })
    //     }
    //   });
    // });
  </script>

</body>

</html>