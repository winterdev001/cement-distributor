<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>KIKU</title>
  <!-- links -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="assets/themify-icons-font/themify-icons/themify-icons.css">
  <!-- <link rel="stylesheet" href="assets/fontawesome-free-5.13.0-web/fontawesome-free-5.13.0-web/css/all.min.css"> -->
  <!-- CSS only -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
    integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk" crossorigin="anonymous">

  <!-- JS, Popper.js, and jQuery -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
    crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
    integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
    crossorigin="anonymous"></script>
  <!-- <link rel="stylesheet" href="css/bootstrap.min.css"> -->
  <link rel="stylesheet" href="css/app.css">
  <link rel="stylesheet" href="css/product_details.css">
</head>

<body>
  <!-- / .breadcrumbs -->
  <div class="container" ng-app="pdetails" ng-controller="pdetailsCtrl">
    <div>
      <header>
        <div include-html="inc/navigation.html"></div>
      </header>
      <!-- breadcrumbs -->
      <div class="container mt-5 mb-5">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb ">
            <li class="breadcrumb-item"><a href="index.html">Home</a></li>
            <li class="breadcrumb-item"><a href="shop.html">Products</a></li>
            <li class="breadcrumb-item active" aria-current="page" id="pname"></li>
          </ol>
        </nav>
      </div>
      <!-- details section -->
      <div class=" card product-detail mb-5">
        <div class="row  card-body">
          <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 product-detail-img-sect">
            <div class=" product_img">
              <div class="image-viewer">
                <div class="main-image">
                  <img ng-src=" images/products/{{show_image}} " on-error="images/err.png" />
                </div>
                <!-- <div class="secondary-images">
                  <div class="secondary-image">
                    <img src="images/house2.jpg" />
                  </div>
                  <div class="secondary-image">
                    <img src="images/road.jpg" />
                  </div>
                  <div class="secondary-image">
                    <img src="images/testimonial2.jpg" />
                  </div>
                  <div class="secondary-image">
                    <img src="images/random.jpg" />
                  </div>
                </div> -->
              </div>
            </div>
          </div>
          <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12 ">
            <div class=" product_details">
              <div class="">
                <div class="detail">
                  <div class="row">
                    <div class="col-md-9">
                      <h1 class="detail-name"> {{show_product_name}} </h1>
                    </div>
                    <div class="col-md-3">
                      <a class="btn btn-light" onclick="goBack()" href="">Go Back</a>
                    </div>
                  </div>
                  <p class="card-text">
                    <span class="price-tags">{{show_amount}}Rwf</span>
                  </p>
                  <p class="detail-short-description">
                    {{show_product_name}} is a sure and well tested product imported by kiku after being manufactured by
                    {{show_manufacturer}}.
                  </p>

                </div>

                <div class="pricing mt-5">
                  <div class="row">
                    <div class="col-lg-2 col-md-2 col-sm-12 col-xs-12 pkg-sec">
                      <span class=" text-center pkg"><strong style="font-size: 20px;">PKG:</strong></span>
                    </div>
                    <div class="col-lg-4 col-md-4 col-sm-12 col-xs-12">
                      <div class="num-block skin-6 ">
                        <div class="num-in rounded-pill">
                          <span class="minus dis ">-</span>
                          <input type="text" class="in-num" readonly="" ng-model="kwantity">
                          <span class="plus">+</span>
                        </div>
                      </div>
                    </div>
                    <div class=" col-lg-4 col-md-4 col-sm-12 col-xs-12">
                      <div class="add-order-sec">
                        <button class="btn   rounded-pill  add-order-btn"
                          ng-click="addToCart(show_product_id,show_product_name,kwantity,show_amount)">Add to
                          Cart</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- broad description -->
      <!-- <h1 class="title">FanTabulous</h1> -->
      <div class="description-container mt-5 mb-5">
        <div id="icetab-container">
          <div class="icetab current-tab">Pricing</div>
          <div class="icetab">Product Specifications</div>
          <div class="icetab">Product Description</div>
          <div class="icetab">Delivery & Trade Policy</div>
          <div class="icetab">Product Reviews </div>
        </div>

        <div id="icetab-content">
          <div class="tabcontent tab-active">
            <strong>Minum Order Quantity</strong> : <span>10 Package/Bags</span><br>
            <strong>Price</strong> : <span>Rwf {{show_amount}} per bag.</span><br>
            <strong>Payment method</strong> : <span>Cash, Credit Card</span><br>
            <strong>Payment ways</strong> : <span>Cash transfer/wire, Pay per delivery.</span>
          </div>
          <div class="tabcontent">
            <strong>Fineness</strong> : <span>{{show_fineness}}</span><br>
            <strong>Compressive Strength</strong> : <span>{{show_strength}}+ Megapascals (MPa )</span><br>
            <strong>Color</strong> : <span>{{show_color}}</span><br>
            <strong>Weight</strong> : <span>{{show_weight}}Kilograms (kg)</span><br>
            <strong>Cement Raw Material</strong> : <span>Other</span><br>
            <strong>Cement Type</strong> : <span>Other </span><br>
            <strong>Sand TypeNatural</strong> : <span>Sand</span><br>
            <strong>Hardening Feature</strong> : <span>Extra Rapid Hardening</span><br>
            <strong>Product Strength Grade</strong> : <span>{{show_strength}}+ mpa</span>
          </div>
          <div class="tabcontent">
            <table class="table table-bordered">
              <tbody>
                <tr>
                  <td>
                    <strong>Packaging Size</strong>
                  </td>
                  <td>
                    {{show_weight}} Kgs
                  </td>
                </tr>
                <tr>
                  <td>
                    <strong>Usage/Application</strong>
                  </td>
                  <td>
                    {{show_application}}
                  </td>
                </tr>
                <tr>
                  <td>
                    <strong>Color</strong>
                  </td>
                  <td>
                    {{show_color}}
                  </td>
                </tr>
                <tr>
                  <td>
                    <strong>Compressive Strength</strong>
                  </td>
                  <td>
                    {{show_strength}}+ mpa
                  </td>
                </tr>
                <tr>
                  <td>
                    <strong>Packaging Type</strong>
                  </td>
                  <td>
                    {{show_packaging_type}}
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="tabcontent">
            <h2>Delivery policy for our store</h2>
            <p>After Orders have been placed, products are delivered to our customers, and as always for products that
              exceed 500 kg in weight are delivered for free but only for those who are located 1 Km away from the
              store.
              If you are located in more than 1 Km away from the store, the delivery fair will be applied and to be paid
              by the customer.</p>
            <ul>
              <li>1-2 business days (Typically by end of day)</li>
              <li><a href="#">30 days money back guaranty</a></li>
              <li>24/7 live support</li>
              <li>odio dignissim qui blandit praesent</li>
              <li>luptatum zzril delenit augue duis dolore</li>
              <li>te feugait nulla facilisi.</li>
            </ul>

          </div>
          <div class="tabcontent">
            <h3>Customer Reviews</h3>
            <span>No reviews for this product.</span><br>
            <button class="btn  rounded-pill add-review-btn" data-toggle="modal" data-target="#add_review">Add
              Review</button>
          </div>
        </div>
      </div>
    </div>
    <!--/ .broad description  -->

    <!-- / .details section -->

    <!-- Related Products -->
    <section>
      <div class="container">
        <h3 class="text-center mb-5">Related Products</h3>
        <div class="row">
          <div class="MultiCarousel" data-items="1,2,3,4" data-slide="1" id="MultiCarousel" data-interval="1000">
            <div class="MultiCarousel-inner" ng-repeat="product in products | orderBy:'created_at' | limitTo:4">
              <a href="" class="text-decoration-none">
                <div class="item card">
                  <img ng-src=" images/products/{{product.image}} " on-error="images/err.png" class="card-img-top"
                    alt="" height="250" width="500">
                  <div class=" card-body">
                    <h5 class="card-title text-center text-dark">{{product.product_name}}</h5>
                    <p class="card-text last-color-cl text-center">Rwf {{product.amount}}</p>
                    <p>
                      <span><button class="btn btn-blu font-weight-bold" ng-click="toShowProduct(product.id)"><i
                            class="ti-eye"></i></button></span>
                      <span class="float-right"><button class="btn btn-grin" id="add_to_cart"
                          ng-click="addToCart(product.id,product.product_name,10,product.amount)"><i
                            class="ti-shopping-cart"></i></button></span>
                    </p>
                  </div>
                </div>
              </a>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- / .Related Products -->
    <!-- modals -->
    <!-- cart modal -->
    <div class="modal fade" id="cart_status" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true"
      data-refresh="true">
      <div class="modal-dialog modal-lg cart-status">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Your cart <i class="ti-shopping-cart"></i> | <span
                class="badge badge-secondary">{{cart_items}}</span></h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <table class="table table-stripped">
              <thead>
                <th></th>
                <th>Price</th>
                <th>Qty</th>
                <th>Total</th>
                <th>action</th>
              </thead>
              <tbody>
                <tr ng-repeat="ctp in ctproducts">
                  <td>{{ctp.product_name}}</td>
                  <td>{{ctp.amount}}</td>
                  <td><input type="text" class="fomr-control" ng-change="updateCartQty(ctp.id,ctp.quantity)"
                    ng-model="ctp.quantity"></td>
                  <td>{{ctp.amount * ctp.quantity}}</td>
                  <td><button class="btn btn-warning" ng-click="rmvProdFrmCart(ctp.id)">Remove</button></td>
                </tr>
                <tr>
                  <td colspan="3" class="mx-auto">Grand Total</td>
                  <td>{{cart_total}}</td>
                  <td><button class="btn btn-danger" ng-click="clearCart()">Empty Cart</button></td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Continue Shopping</button>
            <button type="button" class="btn btn-primary">Checkout</button>
          </div>
        </div>
      </div>
    </div>
    <!-- end cart modal -->

    <!-- product reviews Modal -->
    <!-- <div class="modal fade" id="add_review" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
      aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">Add a Review</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <form action="">
            <div class="modal-body">
              <p class="m-2">
                *Your email address will not be published, Remember to fill all fields.
              </p>
              <div class="form-group">
                <textarea class="form-control col-md-6 col-sm-12" rows="3" name="content"
                  placeholder="Your Review..."></textarea>
              </div>
              <div class="form-group">
                <input class="form-control col-md-4 col-sm-6" type="text" name="email" placeholder="Email *">
              </div>
              <input type="hidden" name="for" value="product">
              <input type="hidden" id="for_id" name="for_id" value="{{$product->id}}">
              <input type="submit" value="Send">
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
              <button type="button" class="btn third-color add-review-btn">Save changes</button>
            </div>
          </form>
        </div>
      </div>
    </div> -->
    <!-- / .product reviews Modal -->
    <!-- modals -->
  </div>



  <div class="to-top">
    <a href="#" onclick="topFunction()" id="myBtn" title="Go to top">
      <span class="d-flex align-content-center"><i class="fa fa-chevron-up"></i></span>
    </a>
  </div>
  <!-- footer -->
  <div include-html="inc/footer.html"></div>
  <!-- / .footer -->
  <!-- scripts -->

  <script src="js/app.js"></script>
  <script src="js/angular.min.js"></script>
  <script src="js/sweetalert1.js"></script>
  <!-- <script src="js/custom.js"></script> -->
  <script>
    // console.log('hello');
    var app = angular.module('pdetails', []);

    app.controller('pdetailsCtrl', function ($scope, $http, $window) {

      $scope.kwantity = 10;
      var storedId = localStorage.getItem('id');
      $scope.showProduct = () => {

        let show_products = {
          method: 'POST',
          url: 'api/product_details.php',
          data: {
            id: storedId
          }
        };
        $http(show_products).then((res) => {
          data = res.data;
          // console.log(res.data);
          $scope.show_fineness = data[0].fineness;
          $scope.show_strength = data[0].compressive_strength;
          $scope.show_color = data[0].color;
          $scope.show_weight = data[0].weight;
          $scope.show_application = data[0].application;
          $scope.show_packaging_type = data[0].packaging_type;
          $scope.show_product_name = data[0].product_name;
          $scope.show_quantity = data[0].quantity;
          $scope.show_amount = data[0].amount;
          $scope.show_manufacturer = data[0].manufacturer;
          $scope.show_product_id = data[0].id;
          $scope.show_image = data[0].image;
          $('#pname').html($scope.show_product_name);

        });

      }

      $scope.showProduct();

      $scope.getfeed = () => {
        $http.get("api/getData.php").then((Response) => {
          $scope.products = Response.data;
          // console.log(Response)
        })
      }

      $scope.getfeed();

      $scope.toShowProduct = (id) => {
        // $window.location.href = 'product_details.html';
        // alert('hello')
        if (localStorage.getItem('id') == null) {
          var addId = localStorage.setItem('id', id);
          $window.location.href = 'product_details.html';
        } else {
          localStorage.removeItem('id');
          var addId = localStorage.setItem('id', id)
          $window.location.href = 'product_details.html';
          var getId = localStorage.getItem('id');
          console.log(getId);
        }
      }

      if (localStorage.getItem('username') != null) {
        $scope.username = localStorage.getItem('username');
        $scope.loggedin = true;
        $scope.notuser = false;
      } else {
        $scope.loggedin = false;
        $scope.notuser = true;
      }

      $scope.logout = () => {
        $scope.loggedin = false;
        $scope.notuser = true;
        if (localStorage.getItem('username') != null) {
          var removeUser = localStorage.removeItem('username');
          // $window.location.href = "./dashboard/dash.html";
        }
        $window.location.href = "api/logout.php";
      }

      // cart functions

      // add product to cart     
      $scope.initialCart = () => {
        $http.get('api/getcartstatus.php').then((res) => {
          if (res.data == 'No data') {
            $scope.cart_items = 0;
            // console.log($scope.cart_items)
          } else {
            $scope.cart_items = res.data.length;
            // console.log(res.data)
          }
        });
      }
      $scope.initialCart();

      $scope.addToCart = (id, name, qty, amount) => {
        let cart_stuff = {
          method: 'POST',
          url: 'api/addtocart.php',
          data: {
            pid: id,
            pname: name,
            qty: qty,
            price: amount
          }
        }
        $http(cart_stuff).then((response) => {
          datas = response.data;
          if (datas == 'done') {
            $http.get('api/getcartstatus.php').then((res) => {
              $scope.cart_items = res.data.length;
            });
            swal({
              title: 'Product added to cart!.',
              // text: 'Redirecting...',
              icon: "success",
              timer: 1500,
              buttons: true,
            });
          } else {
            swal({
              text: response.data,
              timer: 1500
            });
          }
        });
      }

      // get cart products
      $scope.getCartProducts = () => {
        $http.get('api/getcartstatus.php').then((res) => {
          if (res.data == 'No data') {
            swal({
              title: "No product choosen yet.",
            });
          } else {
            $scope.ctproducts = res.data;
            $("#cart_status").modal('show');
            $scope.getCartTotal();
          }
        });
      }


      $scope.getCartTotal = () => {
        $http.get('api/carttotal.php').then((response) => {
          $scope.cart_total = response.data[0].total;
        });
      }

      $scope.getCartTotal();


      $scope.rmvProdFrmCart = (id) => {
        let selected_products = {
          method: 'POST',
          url: 'api/removecartproduct.php',
          data: {
            'id': id
          }
        }
        if (id != null) {
          swal({
            title: "Are you sure?",
            // text: "Once deleted, you will not be able to recover this imaginary file!",
            icon: "warning",
            buttons: true,
            dangerMode: true,
          }).then((result) => {
            if (result) {
              $http(selected_products).then((res) => {
                if (res.data == 'done') {
                  swal("Deleted!", {
                    icon: "success",
                  }).then((result) => {
                    $scope.getCartProducts();
                    $scope.initialCart();
                    // $scope.CalculateSum();
                  });
                } else if (res.data == 'no data left') {
                  swal("Deleted!", {
                    icon: "success",
                  }).then((result) => {
                    $("#cart_status").modal('hide');
                    $window.location.reload();
                  });
                } else {
                  swal({ text: res.data });
                }
              })
            }
          })
        }
      }

      $scope.clearCart = () => {
        swal({
          title: "Are you sure?",
          text: "All selected products will be romoved.",
          icon: "warning",
          buttons: true,
          dangerMode: true,
        }).then((result) => {
          if (result) {
            $http.get('api/clearcart.php').then((res) => {
              if (res.data == 'done') {
                swal("Removed!", {
                  icon: "success",
                }).then((result) => {
                  $("#cart_status").modal('hide');
                  $window.location.reload();
                });
              } else {
                swal({ text: res.data });
              }
            })
          }
        })
      }

      $scope.updateCartQty = (id, qty) => {
        console.log(id, qty);
        if (qty < 10) {
          swal({ text: "Quantity can not go beyond 10, if not changed quantiy will be set to 10 by default", icon: "warning" });
        } else {
          let cart_updates = {
            method: 'POST',
            url: 'api/updatecart.php',
            data: {
              id: id,
              qty: qty
            }
          }

          $http(cart_updates).then((response) => {
            if (response.data == 'done') {
              $scope.getCartProducts();
              $scope.initialCart();
            } else {
              swal("failed");
            }
          });
        }
      }

    });

    app.directive('onError', function () {
      return {
        restrict: 'A',
        link: function (scope, element, attr) {
          element.on('error', function () {
            element.attr('src', attr.onError);
          })
        }
      }
    })

  </script>
  <!-- <script>
    var app = angular.module('pname', []);

    app.controller('pnameCtrl', function ($scope, $http) {
      var storedId = localStorage.getItem('id');
      $scope.showProduct = () => {

        let show_products = {
          method: 'POST',
          url: 'api/product_details.php',
          data: {
            id: storedId
          }
        };
        $http(show_products).then((res) => {
          data = res.data;
          $scope.show_product_name = data[0].product_name;
        });

      }

      $scope.showProduct();

    });

    
  </script> -->
  <style>
    /* back to top button */

    #myBtn {
      width: 50px;
      height: 50px;
      display: none;
      position: fixed;
      bottom: 20px;
      right: 30px;
      z-index: 99;
      border: none;
      outline: none;
      font-size: 25px !important;
      color: white;
      cursor: pointer;
      padding: 10px 10px 10px 11px;
      border-radius: 50%;
      box-shadow: 1px 1px 5px #000;
      background-color: #00c292;
      text-decoration: none;
    }

    #myBtn:hover {
      background-color: #a4a4a4;
    }

    /* / .back to top */
  </style>
  <script>
    // back to top button

    window.onscroll = function () { scrollFunction() };

    function scrollFunction() {
      if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) {
        document.getElementById("myBtn").style.display = "block";
      } else {
        document.getElementById("myBtn").style.display = "none";
      }
    }

    function topFunction() {
      $('html,body').animate({ scrollTop: 0 }, 1000);
    }
    // /.back to top button
  </script>
  <script>
    function goBack() {
      window.history.back();
    }
  </script>
</body>

</html>